(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{142:function(t,e,a){},144:function(t,e,a){},146:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a.n(n),r=a(46),c=a.n(r),s=a(2),o=a(1),l=a(8),u=a(7),h=a(9),d=a(12),v=a.n(d),f=a(47),g=a.n(f),b=(a(55),function(t){var e=t.children;return i.a.createElement("td",{className:"p-1",align:"center",valign:"center"},e)}),m=function(t){var e=t.className,a=t.onClick,n=e.split(" ").join("-");return i.a.createElement("td",{className:"p-1",align:"center",valign:"center"},i.a.createElement("button",{className:n,type:"button",onClick:a}))},y=function(t){function e(t){var a;Object(s.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).onClick=function(t,e){return function(){var n=a.state.table;n.getCell(t,e).trigger(),a.setState({table:n})}},a.renderCloumns=function(){var t=a.state.table,e=a.props.onClick;return t.getTable().map(function(t,a){return i.a.createElement("tr",{key:Object(d.uniqueId)()},t.map(function(t,n){if(t.isHeader())return i.a.createElement(b,{key:Object(d.uniqueId)()},t.getState());var r=g()({btn:!0,cell:!0,active:t.getState()});return i.a.createElement(m,{key:Object(d.uniqueId)(),className:r,onClick:e(a,n)})}))})};var n=a.props.table;return a.state={table:n},a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"componentWillReceiveProps",value:function(t){this.setState({table:t.table})}},{key:"render",value:function(){return i.a.createElement("div",{className:"container-fluid",align:"center"},i.a.createElement("table",{className:"table-borderless",align:"center"},i.a.createElement("tbody",null,this.renderCloumns())))}}]),e}(i.a.Component);y.Head=b,y.ButtonCell=m;var p=a(5),k=a(10),x=a(49),w=function(){function t(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(s.a)(this,t),this.state=e,this.header=a,this.i=n,this.j=i}return Object(o.a)(t,[{key:"trigger",value:function(){this.state=!this.state}},{key:"getState",value:function(){return this.state}},{key:"isHeader",value:function(){return this.header}}]),t}(),j=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(s.a)(this,t),this.id=e,this.connectsTo=a}return Object(o.a)(t,[{key:"isConnectedTo",value:function(t){var e=t.id;return!!this.connectsTo.find(function(t){return t.id===e})}}]),t}(),O=function(){function t(e){var a=this;Object(s.a)(this,t),this.makeLine=function(){for(var t=1;t<a.resolution+1;t+=1)for(var e=1;e<a.resolution+1;e+=1)e-t===1&&a.table[t][e].trigger();return a.table},this.resolution=e,this.table=this.generateTable().makeLine()}return Object(o.a)(t,[{key:"generateTable",value:function(){this.table=[];for(var t=0;t<this.resolution+1;t+=1){this.table[t]=[];for(var e=0;e<this.resolution+1;e+=1)this.table[t][e]=0===t?new w(0!==e?e:null,!0):0===e?new w(0!==t?t:null,!0):new w(!1,!1,t,e)}return this}}]),Object(o.a)(t,[{key:"getMatrix",value:function(){var t=this.table.map(function(t){return t.filter(function(t){return!0!==t.header})});return v.a.drop(t)}},{key:"getTable",value:function(){return this.table}},{key:"getNodes",value:function(){return this.getMatrix().reduce(function(t,e,a){var n=e.reduce(function(t,e){return e.state?[].concat(Object(x.a)(t),[e.j]):t},[]),i=a+1;return Object(k.a)({},t,Object(p.a)({},i,new j(i,n)))},{})}},{key:"getCell",value:function(t,e){return this.table[t][e]}}]),t}(),E=a(3),C=a(48),S=a.n(C),N=(a(142),function(t){function e(){return Object(s.a)(this,e),Object(l.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(o.a)(e,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var t=this.props.contextRef;return i.a.createElement("canvas",{style:{width:"100%",height:"500px"},ref:function(e){return e?t(e.getContext("2d")):null}})}}]),e}(i.a.Component)),M=function(){function t(e,a,n,i){var r=this,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#06266F",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#06266F",l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"#2A4480";Object(s.a)(this,t),this.draw=function(t){var e=1.1*r.radius;t.arc(r.x,r.y,r.radius,0,2*Math.PI,!1),t.strokeStyle=r.color,t.fillStyle=r.color,t.stroke(),t.fill(),t.font="".concat(e,"px Arial"),t.textAlign="center",t.textBaseline="middle",t.strokeStyle="white",t.fillStyle="white",t.fillText(r.id,r.x,r.y+.045*e)},this.setX=function(t){r.x=t},this.setY=function(t){r.y=t},this.setSize=function(t){r.radius=t},this.setColor=function(t){switch(t){case"default":r.color=r.defaultColor;break;case"dragged":r.color=r.dragColor;break;default:r.color=t}},this.x=e,this.y=a,this.radius=n,this.id=i,this.color=c,this.defaultColor=o,this.dragColor=l}return Object(o.a)(t,[{key:"getScaledSize",value:function(t,e){var a=getComputedStyle(t.canvas),n=parseInt(a.getPropertyValue("width"),10)/(e*Math.PI*.8),i=n<16?16:n;return i>40?40:i}}]),t}(),I=function(t,e){var a=Object.keys(e);return a.reduce(function(n,i){var r=e[i].id,c=new M(0,0,0,r),s=c.getScaledSize(t,a.length);return c.setSize(s),Object(k.a)({},n,Object(p.a)({},r,c))},{})},P=function(){function t(e,a,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#0C0874",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:14;Object(s.a)(this,t),this.fromNodeId=String(e),this.toNodeId=String(a),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.circleRadius=0,this.id=String(n),this.color=String(i),this.arrowHeadRadius=r}return Object(o.a)(t,[{key:"setFrom",value:function(t){this.x1=t.x,this.y1=t.y}},{key:"setTo",value:function(t){this.x2=t.x,this.y2=t.y}},{key:"setCircleRadius",value:function(t){this.circleRadius=t}},{key:"drawDefault",value:function(t){t.beginPath(),t.moveTo(this.x1,this.y1),t.lineWidth=5,t.lineTo(this.x2,this.y2),t.strokeStyle=this.color,t.stroke(),t.restore(),t.save();var e,a,n,i=this.arrowHeadRadius,r={x:this.x2,y:this.y2},c=this.x1,s=this.y1,o=r.x,l=r.y;t.beginPath(),e=Math.atan2(r.y-s,r.x-c),a=i*Math.cos(e)+o,n=i*Math.sin(e)+l,t.moveTo(a,n),e+=2/3*(2*Math.PI),a=i*Math.cos(e)+o,n=i*Math.sin(e)+l,t.lineTo(a,n),e+=2/3*(2*Math.PI),a=i*Math.cos(e)+o,n=i*Math.sin(e)+l,t.lineTo(a,n),t.closePath(),t.strokeStyle=this.color,t.fillStyle=this.color,t.fill(),t.restore()}},{key:"drawIndeslf",value:function(t){var e=this.circleRadius/2,a=this.circleRadius/4,n=getComputedStyle(t.canvas),i=parseInt(n.getPropertyValue("width"),10),r=parseInt(n.getPropertyValue("height"),10)/2,c=.2*(i/2-this.x1),s=.2*(r-this.y1);c=c>a?e:c<-a?-e:c,s=s>a?e:s<-a?-e:s,t.save(),t.beginPath(),t.lineWidth=5,t.arc(this.x1-c,this.y1-s,this.circleRadius,0,2*Math.PI),t.closePath(),t.strokeStyle=this.color,t.stroke(),t.restore()}},{key:"draw",value:function(t){this.fromNodeId===this.toNodeId&&this.drawIndeslf(t),this.drawDefault(t)}}]),t}(),T=function(t,e){return Object.keys(e).reduce(function(t,a){var n=e[a].connectsTo.map(function(t){return new P(a,t,a)});return n.length>0?Object(k.a)({},t,Object(p.a)({},a,n)):t},{})},R=function(t,e,a){return Object.keys(e).forEach(function(t){e[t].forEach(function(t){var e=t.fromNodeId,n=t.toNodeId,i=a[e],r=a[n],c={x:i.x,y:i.y},s=function(t,e,a,n,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=function(t,e,a){return t*e+a},s=(n-e)/(a-t),o=(n*t-e*a)/(t-a)+(s*a-n),l=Math.pow(2*o*s,2)+4*(1+Math.pow(s,2))*(Math.pow(i+r,2)-Math.pow(o,2)),u=(-2*o*s-Math.sqrt(l))/(-2*(1+Math.pow(s,2))),h=c(s,u,o),d=(-2*o*s+Math.sqrt(l))/(-2*(1+Math.pow(s,2))),v=c(s,d,o);return t>=a?{x:u+a,y:h+n}:{x:d+a,y:v+n}}(i.x,i.y,r.x,r.y,r.radius,t.arrowHeadRadius);t.setFrom(c),t.setTo(s),t.setCircleRadius(r.radius)})}),e},F=function(t,e,a){a(function(t,e){var a=t.canvas.getBoundingClientRect();return{x:e.clientX,y:e.clientY-a.top}}(t,e))},z=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},B=function(t){function e(t){var a;return Object(s.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={circles:null,arrows:null,dragged:!1},a.update=a.update.bind(Object(E.a)(Object(E.a)(a))),a.saveContext=a.saveContext.bind(Object(E.a)(Object(E.a)(a))),a.draw=a.draw.bind(Object(E.a)(Object(E.a)(a))),a.moveEvent=a.moveEvent.bind(Object(E.a)(Object(E.a)(a))),a.clickTrigger=a.clickTrigger.bind(Object(E.a)(Object(E.a)(a))),a.scaleFigures=a.scaleFigures.bind(Object(E.a)(Object(E.a)(a))),a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.ctx.canvas.addEventListener("resize",this.update),window.addEventListener("mousemove",function(e){return F(t.ctx,e,t.moveEvent)}),window.addEventListener("mousedown",function(e){return F(t.ctx,e,t.clickTrigger)}),window.addEventListener("mouseup",function(e){return F(t.ctx,e,function(){var e=t.state.dragged;e&&e.setColor("default"),t.setState({dragged:!1})})}),this.ctx.canvas.addEventListener("touchstart",function(e){var a=e.touches[0];a&&F(t.ctx,a,t.clickTrigger)},!1),this.ctx.canvas.addEventListener("touchmove",function(e){var a=e.touches[0];t.state.dragged&&(e.preventDefault(),e.stopPropagation()),a&&F(t.ctx,a,t.moveEvent)},!1),this.ctx.canvas.addEventListener("touchend",function(e){var a=e.touches,n=t.state.dragged;a&&F(t.ctx,a,function(){n&&n.setColor("default"),t.setState({dragged:!1})})},!1);var e=this.props.nodes,a=I(this.ctx,e),n=T(this.ctx,e);this.scaleFigures(a,n)}},{key:"componentWillReceiveProps",value:function(t){var e=I(this.ctx,t.nodes),a=T(this.ctx,t.nodes);this.scaleFigures(e,a)}},{key:"componentDidUpdate",value:function(){this.setupCanvas(),this.draw(this.ctx)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.rAF)}},{key:"setupCanvas",value:function(){var t=this.ctx,e=window.devicePixelRatio||1,a=t.canvas.getBoundingClientRect();t.canvas.width=a.width*e,t.canvas.height=a.height*e,t.scale(e,e)}},{key:"saveContext",value:function(t){this.ctx=t,this.width=this.ctx.canvas.width,this.height=this.ctx.canvas.height}},{key:"update",value:function(){var t=this.state,e=t.circles,a=t.arrows;this.scaleFigures(e,a)}},{key:"scaleFigures",value:function(t,e){!function(t,e){var a=Object.keys(e);a.forEach(function(n){var i=e[n],r=i.getScaledSize(t,a.length);i.setSize(r)})}(this.ctx,t);var a=function(t,e){var a=e[1].radius,n=getComputedStyle(t.canvas),i=parseInt(n.getPropertyValue("width"),10),r=parseInt(n.getPropertyValue("height"),10),c=Object.keys(e),s=2.5*a,o=i/2-(c.length*s-s)/2;return c.reduce(function(t,a){var n=e[a],i=n.id%2===0?r/3:-r/3;return n.setX(o),n.setY(r/2+i),o=n.x+2.5*n.radius,Object(k.a)({},t,Object(p.a)({},a,n))},{})}(this.ctx,t),n=R(this.ctx,e,a);this.setState({circles:a,arrows:n})}},{key:"draw",value:function(t){var e=this.state,a=e.circles,n=e.arrows;t.save(),t.beginPath(),t.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),Object.keys(n).forEach(function(e){n[e].forEach(function(e){e.draw(t)})}),Object.keys(a).forEach(function(e){var n=a[e];t.beginPath(),n.draw(t)}),t.restore()}},{key:"moveEvent",value:function(t){var e=this,a=this.state,n=a.circles,i=a.arrows,r=a.dragged;if(r){!function(t,e,a){var n=getComputedStyle(t.canvas),i=parseInt(n.getPropertyValue("width"),10),r=parseInt(n.getPropertyValue("height"),10);e.x+a.radius>i?a.setX(i-a.radius):e.x-a.radius<0?a.setX(0+a.radius):a.setX(e.x),e.y+a.radius>r?a.setY(r-a.radius):e.y-a.radius<0?a.setY(0+a.radius):a.setY(e.y),a.setColor("dragged")}(this.ctx,t,r),n[r.id]=r;var c=R(this.ctx,i,n);this.setState({circles:n,arrows:c})}else{var s=Object.keys(n);s.forEach(function(a){var i=n[a],r=z(t,i),c=i.getScaledSize(e.ctx,s.length);r<=4*i.radius?i.setSize(c+(c-r/4)/3):i.setSize(c)});var o=R(this.ctx,i,n);this.setState({circles:n,arrows:o})}}},{key:"clickTrigger",value:function(t){var e=this.state.circles,a=S()(e,function(e){return z(t,e)<=e.radius});a&&this.setState({dragged:e[a]})}},{key:"render",value:function(){return i.a.createElement(N,{contextRef:this.saveContext})}}]),e}(i.a.Component),L=(a(144),window),W=document,A=W.documentElement,V=W.getElementsByTagName("body")[0],q=L.innerWidth||A.clientWidth||V.clientWidth,D=1;D=q<=320?6:q<=375?7:q<=425?8:q<=768?15:18;var H=1,X=function(t){return i.a.createElement("div",{className:"btn-group text-center"},i.a.createElement("button",{type:"button",className:"btn btn-primary shadow-sm",does:"dec",onClick:t.onClick},"- Node"),i.a.createElement("button",{type:"button",className:"btn btn-primary shadow-sm",does:"add",onClick:t.onClick},"+ Node"))},Y=function(t){function e(t){var a;Object(s.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).onButtonClick=function(t){t.preventDefault();var e=t.target.getAttribute("does"),n=a.state.resolution;switch(e){case"add":if(n===D)break;var i=n+1;a.setState({resolution:i,table:new O(i)});break;case"dec":if(n===H)break;var r=n-1;a.setState({resolution:r,table:new O(r)})}},a.onClick=function(t,e){return function(n){var i=a.state.table;i.getCell(t,e).trigger(),a.setState({table:i})}};var n=a.props,i=n.resolution,r=n.table;return a.state={resolution:i,table:r},a}return Object(h.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){var t=this.state.table;return i.a.createElement("div",{className:"container-main"},i.a.createElement("div",{className:"container-header"},i.a.createElement("div",{className:"row justify-content-center"},i.a.createElement("div",{className:"col"},i.a.createElement("h1",{className:""},"Graph App"),i.a.createElement("p",{className:"lead"},"This is a simple app for drawing graph from markov chain matrix. Made on React.")))),i.a.createElement("div",{className:"container-fluid container-content",align:"center"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col",align:"center"},i.a.createElement(X,{onClick:this.onButtonClick}))),i.a.createElement("br",null),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col",align:"center"},i.a.createElement(y,{table:t,onClick:this.onClick}))),i.a.createElement("br",null),i.a.createElement("div",{className:"row"},i.a.createElement(B,{nodes:t.getNodes()}))))}}]),e}(i.a.Component);Y.defaultProps={resolution:3,table:new O(3)},Y.Buttons=X;var U=document.getElementById("react-container");c.a.render(i.a.createElement(Y,null),U)},50:function(t,e,a){t.exports=a(146)},55:function(t,e,a){}},[[50,2,1]]]);
//# sourceMappingURL=main.8e5202e0.chunk.js.map